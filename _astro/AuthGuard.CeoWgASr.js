import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.WFquGv8Z.js";import c from"./NewThreadForm.BtmGrEN9.js";function d(){const[i,o]=a.useState(""),[n,s]=a.useState(!1),u=async e=>{if(e.preventDefault(),!window.supabaseClient){console.error("Supabase client not found on window"),s(!1);return}s(!0);const{error:r}=await window.supabaseClient.auth.signInWithOtp({email:i});alert(r?r.message:"Check your email for the login link!"),s(!1)};return t.jsxs("form",{onSubmit:u,className:"login-form",children:[t.jsx("input",{type:"email",placeholder:"Your email",value:i,onChange:e=>o(e.target.value)}),t.jsx("button",{type:"submit",disabled:n,children:n?"Sending...":"Send Magic Link"})]})}function g({initialSession:i}){const[o,n]=a.useState(i?.user||null),[s,u]=a.useState(!0);return a.useEffect(()=>{const e=async()=>{if(!window.supabaseClient){setTimeout(e,100);return}const{data:{session:r}}=await window.supabaseClient.auth.getSession();n(r?.user||null),u(!1),window.supabaseClient.auth.onAuthStateChange((f,l)=>{n(l?.user||null)})};e()},[]),s?t.jsx("div",{className:"loading-spinner",children:"Checking access..."}):o?t.jsx(c,{user:o}):t.jsx(d,{})}export{g as default};
